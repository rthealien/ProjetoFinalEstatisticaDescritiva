---
title: "Projeto Final - Estatística Descritiva"
author: "Giovanni Angelo, Pedro Weyne, Rafael Oliveira"
date: "20/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)

#coloca o diretório do script como working directory
knitr::opts_knit$set(root.dir = dirname(rstudioapi::getActiveDocumentContext()$path))

#carrega os pacotes necessários
vetor_pacotes = c(
  "readr",
  "ggplot2",
  "plotly",
  "e1071",
  "dplyr",
  "Hmisc",
  "DescTools",
  "kableExtra",
  "gridExtra"
)
lapply(vetor_pacotes, require, character.only = TRUE)
```

## Introdução

Neste projeto vamos fazer uma análise dos dados do ENADE de 2017 referentes ao curso **Música(Licenciatura)**. Segue abaixo uma prévia dos dados importados, filtrados e com rótulos tratados.

```{r intro}
#A
enade2017 = read_csv2("MICRODADOS_ENADE_2017.txt")

#B
microdados_enade_filtrados = enade2017 %>% dplyr::select(
  CO_GRUPO, # Qualitativa Nominal
  CO_REGIAO_CURSO, # Qualitativa Nominal
  NU_IDADE, # Quantitativa Contínua
  TP_SEXO, # Qualitativa Nominal
  CO_TURNO_GRADUACAO, # Qualitativa Nominal
  NT_GER, # Quantitativa Discreta ???
  QE_I01, # Qualitativa Nominal
  QE_I02, # Qualitativa Nominal
  QE_I08, # Qualitativa Ordinal
  QE_I23, # Qualitativa Ordinal
  NT_OBJ_FG # Quantitativa Discreta !!!
)

#C
microdados_musica = microdados_enade_filtrados %>% filter(CO_GRUPO == 4301)

#D
microdados_musica = microdados_musica %>% mutate(
  turno_graduacao = case_when(
    CO_TURNO_GRADUACAO == 1 ~ "Matutino",
    CO_TURNO_GRADUACAO == 2 ~ "Vespertino",
    CO_TURNO_GRADUACAO == 3 ~ "Integral",
    CO_TURNO_GRADUACAO == 4 ~ "Noturno"
    )
)

microdados_musica = microdados_musica %>% mutate(
  estado_civil = case_when(
    QE_I01 == "A" ~ "Solteiro(a)",
    QE_I01 == "B" ~ "Casado(a)",
    QE_I01 == "C" ~ "Separado(a)",
    QE_I01 == "D" ~ "Viúvo(a)",
    TRUE ~ "Outro"
  )
)

microdados_musica = microdados_musica %>% mutate(
  raca = case_when(
    QE_I02 ==    "A" ~ "Branca",
    QE_I02 =="B" ~ "Preta",
    QE_I02 =="C" ~ "Amarela",
    QE_I02 =="D" ~ "Parda",
    QE_I02 =="E" ~ "Indígena",
    QE_I02 =="F" ~ "Não quero declarar"
  )
)

microdados_musica = microdados_musica %>% mutate(
  renda_familiar = case_when(
    QE_I08 == "A" ~ "Até 1,5 salários mínimo (até R$ 1.405,50).",
    QE_I08 == "B" ~ "De 1,5 a 3 salários mínimos (R$ 1.405,51 a R$ 2.811,00).",
    QE_I08 == "C" ~ "De 3 a 4,5 salários mínimos (R$ 2.811,01 a R$ 4.216,50).",
    QE_I08 == "D" ~ "De 4,5 a 6 salários mínimos (R$ 4.216,51 a R$ 5.622,00).",
    QE_I08 == "E" ~ "De 6 a 10 salários mínimos (R$ 5. 622,01 a R$ 9.370,00).",
    QE_I08 == "F" ~ "De 10 a 30 salários mínimo (R$ 9.370,01 a R$ 28.110,00)",
    QE_I08 == "G" ~ "Acima de 30 salários mínimo (mais de R$ 28.110,00)."
  )
) 

microdados_musica = microdados_musica %>% mutate(
  regiao = case_when(
    CO_REGIAO_CURSO == 1 ~ "Norte",
    CO_REGIAO_CURSO == 2 ~ "Nordeste",
    CO_REGIAO_CURSO == 3 ~ "Sudeste",
    CO_REGIAO_CURSO == 4 ~ "Sul",
    CO_REGIAO_CURSO == 5 ~ "Centro-Oeste"
  )
)

#sexo
microdados_musica = microdados_musica %>% mutate(sexo = case_when(TP_SEXO == "M" ~ "Masculino",
                                                          TP_SEXO == "F" ~ "Feminino"))

microdados_musica = microdados_musica %>% mutate(
  hestudos = case_when(
    QE_I23 == "A" ~ "Nenhuma, apenas assisto às aulas",
    QE_I23 == "B" ~ "De uma a três",
    QE_I23 == "C" ~ "De quatro a sete",
    QE_I23 == "D" ~ "De oito a doze",
    QE_I23 == "E" ~ "Mais de doze"
  )
)

head(microdados_musica) %>% kbl %>% kable_material_dark(full_width = T)
```

E segue também a classificação das variáveis selecionadas

```{r classificacao}
qualitativa_quantitativa = c("Qualitativa Nominal", "Qualitativa Nominal","Quantitativa Contínua","Qualitativa Nominal","Qualitativa Nominal","Quantitativa Discreta ???","Qualitativa Nominal","Qualitativa Nominal","Qualitativa Ordinal", "Qualitativa Ordinal","Quantitativa Discreta")
classifica_variaveis = data.frame("Variável" = names(microdados_enade_filtrados), "Classificação" = qualitativa_quantitativa)

classifica_variaveis %>% kbl %>% kable_material_dark(full_width = T)
```

# Data quality e Bloco da análise descritiva das variaveis

## Limpando os dados

```{r limpando os dados_1}
#E
#Contabilizando os Na´s
resumo_nas=microdados_musica %>%
  select(everything()) %>%  
  summarise_all(list(~sum(is.na(.))))

#Removendo  Na´S De todas As variáveis que possuem NA
microdados_musica_sem_NA=microdados_musica %>% na.omit()
```

O dataset filtrado com o curso de **Música(Licenciatura)** possui `r nrow(microdados_musica)` observações, destas foram identificados `r resumo_nas$QE_I01` registros com NA nas variáveis **QE_I01, QE_I02, QE_I08, QE_I23** e `r resumo_nas$NT_GER` registros com NA nas variávaies **NT_GER, NT_OBJ_FG**. Removemos estes registros e passamos a ter um dataset com `r nrow(microdados_musica_sem_NA)` observações.

```{r limpando os dados_2}
#E

#Verificando se foram retirados os NA´S
resumo_nas=microdados_musica_sem_NA %>%
  select(everything()) %>%  
  summarise_all(list(~sum(is.na(.))))

resumo_nas %>% kbl %>% kable_material_dark(full_width = F)
```

## Descrevendo os dados

```{r descrevendo os dados}
#Descrevendo
microdados_descricao = microdados_musica_sem_NA %>%
  select(NT_GER) %>%
  summarise(
    quantidade = n(),
    media = mean(NT_GER),
    mediana = median(NT_GER),
    cv = sd(NT_GER) / media * 100,
    assimetria = skewness(NT_GER),
    curtose = kurtosis(NT_GER)
  ) %>%
  arrange(desc(mediana))

moda = Mode(microdados_musica_sem_NA$NT_GER)

microdados_descricao = microdados_descricao %>% mutate(
  modas = case_when(
    is.na(moda)[1]  ~ "Amodal",
    length(moda) == 1 ~ as.character(moda[1]),
    length(moda) == 2 ~ paste(moda[1],moda[2], sep = " e "),
    TRUE ~ "Multimodal"
  )
)

microdados_descricao %>%
  kbl %>%
  kable_material_dark(full_width = F)

#Estatísticas resumo 
summary(microdados_musica_sem_NA$NT_GER) 

```



